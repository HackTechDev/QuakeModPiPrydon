float(float exponent) LvlForExp =
{
	local float f;
	
	f = sqrt(exponent/80);
	if (f)
		return f;
	else
		return 1;
};
float(float lvel) ExpForLevel =
{
	return (lvel * lvel) * 80;
};
void(entity att, entity targ) GiveExp =
{
	local float e;
	if (att.player.sbarsub)
		GiveExp(att.player.sbarsub.owner, targ);
	e = 1 - (att.lvl - targ.lvl) * 0.1;
	if (e < 0)
		e = 0;
	if (targ.flags & FL_CLIENT)
		e = 10;
	else
		e = e * targ.exp;

	e = ceil(e);
	
	att.exp = att.exp + e;
	if ((att.exp >= ExpForLevel(att.lvl)) && (att.lvl < 50))
	{
		att.lvl = att.lvl + 1;
		// fix autogenerated stats
		Unstat();
		Restat();
		att.health = att.max_health;
		att.mana = att.max_mana; // whee!
		bprint(att.netname, " has advanced to level ", ftos(att.lvl), "\n");
		sound(att, CHAN_AUTO, "player/levelup.wav", 1, ATTN_NONE);
		att.ptd = att.ptd + 5;
	}
};
